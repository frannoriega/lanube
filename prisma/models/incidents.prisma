// Incidents Management

model Incident {
  id          String         @id @default(cuid())
  title       String
  description String?
  status      IncidentStatus @default(OPEN)
  createdAt   DateTime       @default(now()) @map("created_at")
  updatedAt   DateTime       @updatedAt @map("updated_at")

  incidentUsers IncidentUser[]

  @@index([status])
  @@map("incidents")
}

model IncidentUser {
  incidentId String @map("incident_id")
  userId     String @map("user_id")
  checkInId  String @map("check_in_id")

  incident       Incident       @relation(fields: [incidentId], references: [id], onDelete: Cascade)
  registeredUser RegisteredUser @relation(fields: [userId], references: [id], onDelete: Cascade)
  checkIn        CheckIn        @relation(fields: [checkInId], references: [id], onDelete: Cascade)

  @@id([incidentId, userId, checkInId])
  @@map("incident_users")
}
